---
layout: post
title: Linux命令
date: 2019-03-12
tags: linux  
---

<!-- TOC -->autoauto- [CentOS命令](#centos命令)auto- [Ubuntu命令](#ubuntu命令)autoauto<!-- /TOC -->

# CentOS命令

```bash
查看系统版本号：cat /proc/version
查看隐藏文件：ls -a
查看安装软件：yum list installed | grep elasticsearch.noarch
卸载安装软件：yum remove elasticsearch.noarch
查看运行进程：ps -aux
安装软件RPM：rpm -ivh filebeat-1.0.1-x86_64.rpm
查看文件安装路径：whereis logstash
查看资源占用情况：top
关闭服务：systemctl stop firewalld.service
关闭服务自启动：systemctl disable firewalld.service
查看服务状态：systemctl status firewalld.service
修改主机名字：hostnamectl set-hostname admin_keam
查看主机信息：hostnamectl
增加账户：useradd admin_keam   设置账户密码：passwd admin_keam   给新账户增加sudo权限命令：visudo（然后在打开的文件里，找到root ALL(ALL) ALL，往下新增一行admin_keam ALL(ALL) ALL）
更改文件或文件夹所属用户组：chown -R admin_keam /etc/elasticsearch
删除目录：rm -rf firefox
安装zip和unzip命令：yum install zip unzip
解压.zip文件：unzip client.zip
压缩.zip文件：zip -r client.zip client
解压.tgz文件：tar zxvf client.tgz -C client
查看网络端口占用情况：netstat -tunlp
ssh登入：ssh username@ip -p 22
ssh登出：logout
ssh传输：rz -bey
ssh接收：sz xxxx
远程执行命令：sshpass -p passwdxxx ssh -p 22 root@192.168.190.110 "source /etc/profile; cleanenv.sh"  # 注意：远程执行的时候，/etc/profile的全局环境变量是不加载的，只加载bashrc的环境变量，所以这里用到了的话，要动态加载一下
全系统查找文件：find / -name rabbitmq
后台运行：nohup ./xxxx &
覆盖写字符串到文件中：echo "xxxxxx" > /root/test.txt
追加写字符串到文件中：echo "xxxxxx" >> /root/test.txt

# 如果想执行一连串命令，发现有各种相互依赖关系，可以按照如下方式执行。例如，这里想把对应的
a="$(who am i | awk '{print $2}')"; who | awk '{print $2}' | grep -v $a | xargs -n 1 pkill -9 -t
```

# CentOS7安装软件遇到的问题

```txt
CentOS中安装Python3.6简单方法：https://blog.51cto.com/wenguonideshou/2083301
CentOS安装pip失败：https://www.cnblogs.com/saolv/p/6963314.html
```

# CentOS中配置静态上网的方法

```bash
# 虚拟机中NAT模式下CentOS配置静态ip上网：
（1）首先配置静态ip：vim /etc/sysconfig/network-scripts/ifcfg-eth0
DEVICE="eth0"
HWADDR="00:0C:29:6C:BB:E6"
NM_CONTROLLED="yes"
ONBOOT="no"
NETMASK=255.255.255.0
IPADDR=192.168.0.8
GATEWAY=192.168.0.1     # 网关也必须设置，否则无法上网
BOOTPROTO=static        # 这个是核心，默认是dncp
ONBOOT=yes     # 这个必须设置，否则network无法工作
PEERDNS=yes
（2）宿主机（windows）找到本机dns服务器：cmd下，ipconfig
以太网适配器 以太网:

   DHCPv6 IAID . . . . . . . . . . . : 372284451
   DHCPv6 客户端 DUID  . . . . . . . : 00-01-00-01-24-56-C9-BD-1A-F6-43-46-7D-5B
   DNS 服务器  . . . . . . . . . . . : 10.11.56.23
                                       10.11.56.22
                                       10.14.0.131
                                       10.14.0.130

（3）配置CentOS中的dns：vim /etc/resolv.conf
nameserver 10.11.56.23
nameserver 10.11.56.22
nameserver 10.14.0.131
nameserver 10.14.0.130  
# 注意，如果是虚拟机，dns可以设置成网关，比如192.168.0.1
（4）重启network服务：service network restart

注意：如果是两台虚拟机拷贝，即使像上面这样修改了，有一台还是无法上网，原因是mac地址冲突了，两台虚拟机的mac地址一样。这个时候需要修改一下mac地址。
关闭虚拟机，然后编辑***.vmx文件，找到：

ethernet0.addressType = "generated"
uuid.bios = "56 4d ed 23 13 8c 96 91-7c 68 b2 09 8b aa bb cc"
ethernet0.generatedAddress = "00:0c:29:aa:bb:cc"

其中，uuid.bios的后6个数字，就是动态生成的网卡地址的后6位，将这后几位修改掉，就可以改变MAC地址值
```

```bash
# windows（10.17.14.12） ——> vm centos（192.168.2.132） ——> vm centos（172.17.0.2），如何建立隧道访问到虚拟机中的虚拟机
参考：https://eternalcenter.com/?p=2843
```

# mac下，安装vbox（内部centos），解决vbox内虚拟机上网问题

首先，解决虚拟机内部上网问题，使用NAT网络上网  
step1：配置NAT网络。vbox全局设置菜单：VirtualBox ——> 偏好设置 ——> 网络 ——> NAT网络 ——> 添加（假设命名为NatNetwork）；不使用dncp，记住网段10.0.2.0
![png](/images/post/后台框架/vbox-net1.png)
step2：配置vbox虚拟机CentOS的网络设置。网络 ——> 网卡1 ——> 连接方式：NAT网络；界面名称：NatNetwork
![png](/images/post/后台框架/vbox-net2.png)
step3：进入vbox centos系统内，参照![# CentOS中配置静态上网的方法](#CentOS中配置静态上网的方法)，注意使用10.0.2.1作为网关  
step4：test，看虚拟机是否能上网：ping www.baidu.com；看虚拟机是否能联通主机：ping 192.168.31.118  
step5：关闭防火墙。systemctl stop firewalld.service（关闭防火墙）；systemctl disable firewalld.service（禁止开机启动）  
step6：主机尝试ping一下虚拟机（假设静态ip设置为：10.0.2.100），结果是ping不通。此时在宿主机上，ifconfig看不到任何虚拟网卡指向vbox，是因为没有开通host访问。下面步骤是开通虚拟机允许host访问。  
step7：创建vbox主机访问虚拟网卡。vbox全局设置菜单 ——> 管理 ——> 主机网络管理器 ——> 创建一个虚拟网卡vboxnet0  
![png](/images/post/后台框架/vbox-net3.png)
step8：配置虚拟机centos设置，网卡2，host主机访问，选中刚创建的vboxnet0  
step9：进入centos虚拟机中，cp一份虚拟机内部网卡配置。  

```bash
cd /etc/sysconfig/network-scripts  
cp ifcfg-ensp03 ifcfg-ensp08  
vim ifcfg-ensp03  
# 增加HWADDR=xx:xx:xx:xx:xx:xx（这个mac地址，在虚拟机centos设置中网卡高级选项中查看，写成：分割形式）uuid两个配置文件要保证不一样
vim ifcfg-ensp08
# 增加HWADDR=xx:xx:xx:xx:xx:xx，注意修改uuid
# 修改ip地址和网关，注意网段是刚刚生成的192.168.56.xx
```

step10：重启网卡设置。service network restart

# Ubuntu命令

```bash
Ubuntu登陆启用root用户登陆：
$ sudo passwd root
$ sudo vi /usr/share/lightdm/lightdm.conf.d/50-ubuntu.conf
添加如下：
greeter-show-manual-login=true

# 重启，选中login登陆，输入root和密码即可

不让控制台显示全路径
$ vim ~/.bashrc
将所有的w修改为W即可

注意，还需要将/root/.profile结尾的mesg n那行，替换为tty -s && mesg n

另外，为了能正常ssh连接，需要手动安装apt-get install openssh，同时，为了能正常ssh到root用户，需要修改ssh服务配置，如下：
$ /etc/ssh/sshd_config
#PermitRootLogin without-password
PermitRootLogin yes
然后重启ssh服务即可：service ssh restart
```